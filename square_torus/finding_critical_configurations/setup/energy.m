function Ec = energy(w,r,in3)
%ENERGY
%    EC = ENERGY(W,R,IN3)

%    This function was generated by the Symbolic Math Toolbox version 8.1.
%    19-Oct-2020 19:24:36

x1 = in3(:,1);
x2 = in3(:,3);
y1 = in3(:,2);
y2 = in3(:,4);
t3 = periodic_x(x1-x2,y1-y2,0);
t4 = periodic_y(x1-x2,y1-y2,0);
t5 = t3^2;
t7 = t4^2;
t8 = t5+t7;
t9 = periodic_x(x1-x2,y1-y2,1);
t10 = periodic_y(x1-x2,y1-y2,1);
t11 = t9^2;
t12 = t10^2;
t13 = t11+t12;
t14 = periodic_x(x1-x2,y1-y2,2);
t15 = periodic_y(x1-x2,y1-y2,2);
t16 = t14^2;
t17 = t15^2;
t18 = t16+t17;
t19 = periodic_x(x1-x2,y1-y2,3);
t20 = periodic_y(x1-x2,y1-y2,3);
t21 = t19^2;
t22 = t20^2;
t23 = t21+t22;
t24 = periodic_x(x1-x2,y1-y2,4);
t25 = periodic_y(x1-x2,y1-y2,4);
t26 = t24^2;
t27 = t25^2;
t28 = t26+t27;
t30 = sqrt(t8);
t31 = t30*0.5;
t32 = r-t31;
t33 = t32*w;
t34 = exp(t33);
t35 = 1.0/sqrt(t8);
t36 = sqrt(t13);
t37 = t36*0.5;
t38 = r-t37;
t39 = t38*w;
t40 = exp(t39);
t41 = 1.0/sqrt(t13);
t42 = sqrt(t18);
t43 = t42*0.5;
t44 = r-t43;
t45 = t44*w;
t46 = exp(t45);
t47 = 1.0/sqrt(t18);
t48 = sqrt(t23);
t49 = t48*0.5;
t50 = r-t49;
t51 = t50*w;
t52 = exp(t51);
t53 = 1.0/sqrt(t23);
t54 = sqrt(t28);
t55 = t54*0.5;
t56 = r-t55;
t57 = t56*w;
t58 = exp(t57);
t59 = 1.0/sqrt(t28);
t29 = t3*t34*t35*w*0.5+t9*t40*t41*w*0.5+t14*t46*t47*w*0.5+t19*t52*t53*w*0.5+t24*t58*t59*w*0.5;
t60 = t4*t34*t35*w*0.5+t10*t40*t41*w*0.5+t15*t46*t47*w*0.5+t20*t52*t53*w*0.5+t25*t58*t59*w*0.5;
Ec = t29^2*2.0+t60^2*2.0;
