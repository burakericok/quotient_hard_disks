function Ec = energy(w,r,in3)
%ENERGY
%    EC = ENERGY(W,R,IN3)

%    This function was generated by the Symbolic Math Toolbox version 8.1.
%    28-Oct-2020 14:28:17

x1 = in3(:,1);
x2 = in3(:,3);
y1 = in3(:,2);
y2 = in3(:,4);
v = periodic_xy(x1-x2,y1-y2,0);
t3 = v(1);
t4 = v(2);
t5 = t3^2;
t7 = t4^2;
t8 = t5+t7;
v = periodic_xy(x1-x2,y1-y2,1);
t9 = v(1);
t10 = v(2);
t11 = t9^2;
t12 = t10^2;
t13 = t11+t12;
v = periodic_xy(x1-x2,y1-y2,2);
t14 = v(1);
t15 = v(2);
t16 = t14^2;
t17 = t15^2;
t18 = t16+t17;
v = periodic_xy(x1-x2,y1-y2,3);
t19 = v(1);
t20 = v(2);
t21 = t19^2;
t22 = t20^2;
t23 = t21+t22;
v = periodic_xy(x1-x2,y1-y2,4);
t24 = v(1);
t25 = v(2);
t26 = t24^2;
t27 = t25^2;
t28 = t26+t27;
v = periodic_xy(x1-x2,y1-y2,5);
t29 = v(1);
t30 = v(2);
t31 = t29^2;
t32 = t30^2;
t33 = t31+t32;
v = periodic_xy(x1-x2,y1-y2,6);
t34 = v(1);
t35 = v(2);
t36 = t34^2;
t37 = t35^2;
t38 = t36+t37;
t40 = sqrt(t8);
t41 = t40*0.5;
t42 = r-t41;
t43 = t42*w;
t44 = exp(t43);
t45 = 1.0/sqrt(t8);
t46 = sqrt(t13);
t47 = t46*0.5;
t48 = r-t47;
t49 = t48*w;
t50 = exp(t49);
t51 = 1.0/sqrt(t13);
t52 = sqrt(t18);
t53 = t52*0.5;
t54 = r-t53;
t55 = t54*w;
t56 = exp(t55);
t57 = 1.0/sqrt(t18);
t58 = sqrt(t23);
t59 = t58*0.5;
t60 = r-t59;
t61 = t60*w;
t62 = exp(t61);
t63 = 1.0/sqrt(t23);
t64 = sqrt(t28);
t65 = t64*0.5;
t66 = r-t65;
t67 = t66*w;
t68 = exp(t67);
t69 = 1.0/sqrt(t28);
t70 = sqrt(t33);
t71 = t70*0.5;
t72 = r-t71;
t73 = t72*w;
t74 = exp(t73);
t75 = 1.0/sqrt(t33);
t76 = sqrt(t38);
t77 = t76*0.5;
t78 = r-t77;
t79 = t78*w;
t80 = exp(t79);
t81 = 1.0/sqrt(t38);
t39 = t3*t44*t45*w*0.5+t9*t50*t51*w*0.5+t14*t56*t57*w*0.5+t19*t62*t63*w*0.5+t24*t68*t69*w*0.5+t29*t74*t75*w*0.5+t34*t80*t81*w*0.5;
t82 = t4*t44*t45*w*0.5+t10*t50*t51*w*0.5+t15*t56*t57*w*0.5+t20*t62*t63*w*0.5+t25*t68*t69*w*0.5+t30*t74*t75*w*0.5+t35*t80*t81*w*0.5;
Ec = t39^2*2.0+t82^2*2.0;
